<!DOCTYPE html>
<html class="deployment-type-development">
  <head>
    <meta charset="utf-8">
    <base target="_blank">

    <!-- GAME TEST -->
    <script src="../js/fc/ui/diff/Frame.js"></script>
    <script src="../js/fc/ui/diff/DOM-diff.js"></script>
    <script>
      // ensure style="..." changes are completely ignores when building diffs
      DOMdiff.setGlobalIgnore(["style"]);
    </script>
    <script src="../js/fc/ui/diff/diffApply.js"></script>
    <!-- GAME TEST -->

    <title>Arkanoid - A remix on Pong</title>
    <link rel="stylesheet" href="../css/friendlycode.css">
  </head>
  <body style="margin: 0">
    <div id="bare-fc-holder" class="friendlycode-loading"></div>

    <script src="../js/require-config.js"></script>
    <script src="../js/require.min.js"></script>

    <script>
    // Alternate publisher implementation that publishes to a hackpub
    // endpoint. For more information, see:
    //
    //   https://github.com/hackasaurus/hackpub
    //
    // Note also that the Amazon S3 bucket hackpub publishes to must
    // be configured with a CORS configuration that allows for cross-origin
    // GET requests, e.g.:
    //
    //   <CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
    //     <CORSRule>
    //       <AllowedOrigin>*</AllowedOrigin>
    //       <AllowedMethod>GET</AllowedMethod>
    //     </CORSRule>
    //   </CORSConfiguration>

    define("hackpub", ["jquery"], function($) {
      return function Hackpub(options) {
        return {
          loadCode: function(path, cb) {
            var url = options.publishURL + path;
            $.ajax({
              type: "GET",
              url: url,
              dataType: 'text',
              error: function(req) {
                cb(req);
              },
              success: function(html) {
                cb(null, html, url);
              }
            });
          },
          saveCode: function(data, originalURL, cb) {
            $.ajax({
              type: "POST",
              url: options.hackpubURL + "/publish",
              data: {
                'html': data,
                'original-url': originalURL
              },
              dataType: 'json',
              error: function(req) {
                cb(req);
              },
              success: function(result) {
                var url = result['published-url'];
                var path = '/' + url.match(/\/([A-Za-z0-9]+)$/)[1];
                cb(null, {path: path, url: options.publishURL + path});
              }
            });
          }
        };
      };
    });
    </script>

    <script type="text/html" class="pongTemplate">
    
‹h1›Arkanoid!‹/h1›

‹p›‹i›I hacked Pong.‹/i› This used to be a Pong template, but then I went in and totally the entire thing. Now it's arkanoid. ‹strong›Yeah, that happened‹/strong›. W/S that sucker. Let's get some paddling going.‹/p›

‹section id="game"›
  ‹div id="world" tabindex="0"›
    ‹div class="top wall"›‹/div›
    ‹div class="bottom wall"›‹/div›
    ‹div class="wall right"›‹/div›

    ‹div class="paddle left"›‹/div›

    ‹section class="c0 purple" data-diff-ignore-inherit="style data-destroyed"›
      ‹div class="bar p1" onbounce="destroy('.c0 .bar.p1')"›‹/div›
      ‹div class="bar p2" onbounce="destroy('.c0 .bar.p2')"›‹/div›
      ‹div class="bar p3" onbounce="destroy('.c0 .bar.p3')"›‹/div›
      ‹div class="bar p4" onbounce="destroy('.c0 .bar.p4')"›‹/div›
      ‹div class="bar p5" onbounce="destroy('.c0 .bar.p5')"›‹/div›
      ‹div class="bar p6" onbounce="destroy('.c0 .bar.p6')"›‹/div›
    ‹/section›

    ‹section class="c1" data-diff-ignore-inherit="style data-destroyed"›
      ‹div class="bar p1 red"  onbounce="destroy('.c1 .bar.p1')"›‹/div›
      ‹div class="bar p2 blue" onbounce="destroy('.c1 .bar.p2')"›‹/div›
      ‹div class="bar p3 red"  onbounce="destroy('.c1 .bar.p3')"›‹/div›
      ‹div class="bar p4 blue" onbounce="destroy('.c1 .bar.p4')"›‹/div›
      ‹div class="bar p5 red"  onbounce="destroy('.c1 .bar.p5')"›‹/div›
      ‹div class="bar p6 blue" onbounce="destroy('.c1 .bar.p6')"›‹/div›
    ‹/section›

    ‹section class="c2" data-diff-ignore-inherit="style data-destroyed"›
      ‹div class="bar p1 yellow" onbounce="destroy('.c2 .bar.p1')"›‹/div›
      ‹div class="bar p2 green"  onbounce="destroy('.c2 .bar.p2')"›‹/div›
      ‹div class="bar p3 yellow" onbounce="destroy('.c2 .bar.p3')"›‹/div›
      ‹div class="bar p4 green"  onbounce="destroy('.c2 .bar.p4')"›‹/div›
      ‹div class="bar p5 yellow" onbounce="destroy('.c2 .bar.p5')"›‹/div›
      ‹div class="bar p6 green"  onbounce="destroy('.c2 .bar.p6')"›‹/div›
    ‹/section›

    ‹section class="c3" data-diff-ignore-inherit="style data-destroyed"›
      ‹div class="bar p1 blue" onbounce="destroy('.c3 .bar.p1')"›‹/div›
      ‹div class="bar p2 red"  onbounce="destroy('.c3 .bar.p2')"›‹/div›
      ‹div class="bar p3 blue" onbounce="destroy('.c3 .bar.p3')"›‹/div›
      ‹div class="bar p4 red"  onbounce="destroy('.c3 .bar.p4')"›‹/div›
      ‹div class="bar p5 blue" onbounce="destroy('.c3 .bar.p5')"›‹/div›
      ‹div class="bar p6 red"  onbounce="destroy('.c3 .bar.p6')"›‹/div›
    ‹/section›

    ‹section class="c4" data-diff-ignore-inherit="style data-destroyed"›
      ‹div class="bar p1 green"  onbounce="destroy('.c4 .bar.p1')"›‹/div›
      ‹div class="bar p2 yellow" onbounce="destroy('.c4 .bar.p2')"›‹/div›
      ‹div class="bar p3 green"  onbounce="destroy('.c4 .bar.p3')"›‹/div›
      ‹div class="bar p4 yellow" onbounce="destroy('.c4 .bar.p4')"›‹/div›
      ‹div class="bar p5 green"  onbounce="destroy('.c4 .bar.p5')"›‹/div›
      ‹div class="bar p6 yellow" onbounce="destroy('.c4 .bar.p6')"›‹/div›
    ‹/section›

    ‹section class="c5" data-diff-ignore-inhert="style data-destroyed"›
      ‹div class="bar p1 red"  onbounce="destroy('.c5 .bar.p1')"›‹/div›
      ‹div class="bar p2 blue" onbounce="destroy('.c5 .bar.p2')"›‹/div›
      ‹div class="bar p3 red"  onbounce="destroy('.c5 .bar.p3')"›‹/div›
      ‹div class="bar p4 blue" onbounce="destroy('.c5 .bar.p4')"›‹/div›
      ‹div class="bar p5 red"  onbounce="destroy('.c5 .bar.p5')"›‹/div›
      ‹div class="bar p6 blue" onbounce="destroy('.c5 .bar.p6')"›‹/div›
    ‹/section›

    ‹section class="c6" data-diff-ignore-inherit="style data-destroyed"›
      ‹div class="bar p1 yellow" onbounce="destroy('.c6 .bar.p1')"›‹/div›
      ‹div class="bar p2 green"  onbounce="destroy('.c6 .bar.p2')"›‹/div›
      ‹div class="bar p3 yellow" onbounce="destroy('.c6 .bar.p3')"›‹/div›
      ‹div class="bar p4 green"  onbounce="destroy('.c6 .bar.p4')"›‹/div›
      ‹div class="bar p5 yellow" onbounce="destroy('.c6 .bar.p5')"›‹/div›
      ‹div class="bar p6 green"  onbounce="destroy('.c6 .bar.p6')"›‹/div›
    ‹/section›

    ‹section class="c7 purple" data-diff-ignore-inherit="style data-destroyed"›
      ‹div class="bar p1" onbounce="destroy('.c7 .bar.p1')"›‹/div›
      ‹div class="bar p2" onbounce="destroy('.c7 .bar.p2')"›‹/div›
      ‹div class="bar p3" onbounce="destroy('.c7 .bar.p3')"›‹/div›
      ‹div class="bar p4" onbounce="destroy('.c7 .bar.p4')"›‹/div›
      ‹div class="bar p5" onbounce="destroy('.c7 .bar.p5')"›‹/div›
      ‹div class="bar p6" onbounce="destroy('.c7 .bar.p6')"›‹/div›
    ‹/section›

    
    ‹div class="ball b1" data-density="0" data-friction="0" data-bounciness="1"
         onbounce="play('.broing')"›‹/div› 
    ‹!--
    ‹div class="ball b2" data-density="0" data-friction="0" data-bounciness="1"
    data-diff-ignore="style"
    onbounce="play('.broing')"›‹/div› 
    --›
  ‹/div›
  
  ‹div class="scores"›
    ‹span class="left"›0‹/span› : ‹span class="right"›0‹/span›
  ‹/div›

  ‹button onclick="start()"›Start the game‹/button›
  ‹button onclick="pause()"›Pause the game‹/button›
‹/section›

‹audio src="http://labs.petegoodman.com/ghetto_blaster/_includes/sfx/worms/TWANG5.WAV" class="broing"›
‹/audio›

‹!-- STYLING --›
‹style›
 #game {
    text-align: center;
  }

  #world {
    position: relative;
    height: 300px;
    width:  500px;
    background-color: #333;
    vertical-align: middle;
    margin: auto;
    overflow: hidden;
  }
  
  .paddle {
    position: absolute;
    display: inline-block;
    width: 10px;
    height: 100px;
    background-color: green;
    top: 40%;
  }
  
  .paddle.left { left: 10px; }
  .paddle.right { right: 10px; }
  
  .bar {
    position: absolute;
    right: 10px;
    width: 10px;
    height: 30px;
    border: 2px inset #999;
  }

  .c0 div,
  .c1 div,
  .c2 div,
  .c3 div,
  .c4 div,
  .c5 div,
  .c6 div,
  .c7 div { position: absolute; }
  
  .c0 div { left: 310px; }
  .c1 div { left: 340px; }
  .c2 div { left: 360px; }
  .c3 div { left: 380px; }
  .c4 div { left: 400px; }
  .c5 div { left: 420px; }
  .c6 div { left: 440px; }
  .c7 div { left: 470px; }
  
  .p1 { top: 40px; }
  .p2 { top: 80px; }
  .p3 { top: 120px; }
  .p4 { top: 160px; }
  .p5 { top: 200px; }
  .p6 { top: 240px; }
  
  .red,
  .red div { background-color: red !important; }
  .yellow,
  .yellow div { background-color: yellow !important; }
  .blue,
  .blue div { background-color: lightblue !important; }
  .green,
  .green div { background-color: #3A3 !important; }
  .purple,
  .purple div { background-color: #F6F !important; }

  .ball {
    position: absolute;
    background-color: white;
    width: 10px;
    height: 10px;
    top: 50%;
    left: 250px;
  }
  
  .wall {
    position: absolute;
    width: 100%;
    height: 5px;
    background-color: green;
  }
  
  .wall.top { top: 0; }
  .wall.bottom { bottom: 0; }
  .wall.right { right: 0; height: 100%; width: 5px;}
  
  .scores {
    width: 500px;
    margin: auto;
    background: black;
    color: white;
    font-size:200%;
    font-family: monospace;
    font-weight: bold;
  }
  
  *[data-destroyed] {
    opacity: 0.1;
  }
‹/style›

‹!-- SCRIPTS --›
‹script src="../js/Box2dWeb-2.1.a.3.js"›‹/script›
‹script src="../js/physics.js"›‹/script›
</script>


    <script>
    require([
      "jquery",
      "friendlycode",
      "hackpub"
    ], function($, FriendlycodeEditor, Hackpub) {
      var pongTemplate = $(".pongTemplate[type='text/html']").text().replace(/‹/g,'<').replace(/›/g,'>').trim();
      return FriendlycodeEditor({
        container: $("#bare-fc-holder"),
        defaultContent: pongTemplate,
        allowJS: true,
        publisher: Hackpub({
//          hackpubURL: "http://hackpub.hackasaurus.org",
//          publishURL: "http://poof.hksr.us"
          hackpubURL: "http://pomax.nihongoresources.com/downloads/temp/friendlypublish/post.php",
          publishURL: "http://pomax.nihongoresources.com/downloads/temp/friendlypublish/page"
        })
      });
    });
    </script>
  </body>
</html>
